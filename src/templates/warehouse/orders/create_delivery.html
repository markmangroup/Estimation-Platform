{% load static %}

<link rel="stylesheet" href="{% static 'vendors/css/sweetalert2.min.css' %}">

<!-- Add Button -->
<!-- <div class="text-right my-2 mt-3">
        <a
        href="#"
        role="menuitem"
        class="btn bg-light-primary"
        data-backdrop="false" data-toggle="modal" data-target="#create_delivery"
        >
        <em class="ft-plus font-medium-5"></em> Create Delivery
        </a>
</div> -->

<!-- Print Button Start -->
<div class="float-left my-2 mt-3">
  <button type="button" class="btn btn-primary print-button" data-table-id="table1">Print</button>
</div>
<!-- Print Button End -->

<!-- Create Delivery Button Start -->
<div class="float-right my-2 mt-3">
  {% include "./drag_and_select.html" %}
</div>
<!-- Create Delivery Button End -->

<!-- New Table View Start -->
<div>
  <table id="table1" class="table table-striped table-bordered print-table">
    <thead>
      <tr>
        <th style="max-width:100px">Delivery ID</th>
        <th style="max-width:100px">Total Quantity</th>
        <th style="max-width:100px">Contract Start Date</th>
        <th style="max-width:100px">Delivery Date</th>
      </tr>
    </thead>
    <tbody>
      <!--Main Row 1 -->
      <tr>
        <td> PROJ016968	1/2 </td>
        <td> 28 </td>
        <td>2 Apr, 2024</td>
        <td>3 Apr, 2024</td>
      </tr>
      <tr id="collapse11" role="tabpanel" aria-labelledby="headingCollapse11">

        <td>
        </td>

        <!-- Inner table Start -->
        <td colspan="100">
          </div>
          <div class="table-responsive">
            <table
            id="tableBody"
              class="table table-striped table-bordered"
                >
              <thead>
                <tr class="text-center">
                  <th colspan="4" class="align-top">Items Information</th>
                </tr>
                <tr>
                  <th>Sr No</th>
                  <th>Internal Id</th>
                  <th class="text-nowrap">Items</th>
                  <th >Quantity</th>
                </tr>
              </thead>

              <tbody>
                  <tr>
                    <td>1</td>
                    <td> 20315 </td>
                    <td class="text-nowrap">Rental: 10" Plain Coupler</td>
                    <td class="text-nowrap"> 14 </td>
                  </tr>
                  <tr>
                    <td>2</td>
                    <td> 20314 </td>
                    <td class="text-nowrap">Rental: 10" Tapped Coupler</td>
                    <td class="text-nowrap"> 14 </td>
                  </tr>
              </tbody>

            </table>
          </div>

        </td>
        <!-- Inner table End -->
      </tr>

      <!--Main Row 2 -->
      <tr>
        <td> PROJ016968	2/2 </td>
        <td> 28 </td>
        <td>2 Apr, 2024</td>
        <td>3 Apr, 2024</td>
      </tr>
      <tr id="collapse111" role="tabpanel" aria-labelledby="headingCollapse111">

        <td>
        </td>

        <!-- Inner table Start -->
        <td colspan="100">
          </div>
          <div class="table-responsive">
            <table
            id="tableBody"
              class="table table-striped table-bordered"
                >
              <thead>
                <tr class="text-center">
                  <th colspan="4" class="align-top">Items Information</th>
                </tr>
                <tr>
                  <th>Sr No</th>
                  <th>Internal Id</th>
                  <th class="text-nowrap">Items</th>
                  <th >Quantity</th>
                </tr>
              </thead>

              <tbody>
                  <tr>
                    <td>1</td>
                    <td> 20313 </td>
                    <td class="text-nowrap">Rental: 10" X 40' Yelomine Mainline</td>
                    <td class="text-nowrap"> 28 </td>
                  </tr>
              </tbody>

            </table>
          </div>

        </td>
        <!-- Inner table End -->

      </tr>
    </tbody>
  </table>
</div>
<!-- New Table View End -->

<!-- Old Table View  Start -->
<!-- <div class="table-responsive mt-2">
    <table class="table table-stripted file-export">
        <thead>
            <th>Delivery ID</th>
            <th>Material Name</th>
            <th>Quantity</th>
            <th>Pickup Date</th>
            <th>Delivery Date</th>
        </thead>
        <tbody>
            <tr>
                <td>DLI-1</td>
                <td>
                  <p>
                    Rental: 10" Plain Coupler,<br>
                    Rental: 10" Tapped Coupler
                  </p>
                </td>
                <td>
                  <p>
                    14,<br>
                    14
                  </p>
                </td>
                <td>2 Apr, 2024</td>
                <td>3 Apr, 2024</td>
            </tr>

            <tr>
                <td>DLI-2</td>
                <td>
                  <p>Rental: 10" X 40' Yelomine Mainline</p>
                </td>
                <td>
                  <p>28</p>
                </td>
                <td>2 Apr, 2024</td>
                <td>3 Apr, 2024</td>
            </tr>

        </tbody>
    </table>
</div> -->
<!-- Old Table View  End -->

<!-- Create Delivery model Start -->
<div class="modal fade text-left" id="create_delivery" tabindex="-1" role="dialog" aria-labelledby="myModalLabel5" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="myModalLabel5">Create Delivery</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true"
            ><i class="ft-x font-medium-2 text-bold-700"></i
          ></span>
        </button>
      </div>
      <div class="modal-body">
        <section id="multiple-select2">
          <div class="card">
            <div class="card-content">
            <div class="card-body">
                <div class="row">
                  <div class="col-6">
                    <label for="" class="form-label">PickUp Date</label>
                    <input type="date" name="" id="" class="form-control">
                  </div>
                  <div class="col-6 mb-2">
                    <label for="" class="form-label">Delivery Date</label>
                    <input type="date" name="" id="" class="form-control">
                  </div>
                  <div class="col-12">
                    <div class="form-group">
                      <table id="tableBody" class="table table-bordered">
                        <thead>
                          <th>Material name</th>
                          <th>Requested Qty</th>
                          <th>Loaded Quantity</th>
                          <th>Quantity</th>
                          <th></th>
                        </thead>
                        <tbody>
                          <tr id="newProduct">
                            <td>
                              <select class="select2 form-control">
                                <option selected disabled>Select Material Name</option>
                                <option value="Air Vent Assembly">Air Vent Assembly</option>
                                <option value="Air Vent Installation">Air Vent Installation</option>
                                <option value="Automation: Backflush, Clock, Injector">Automation: Backflush, Clock, Injector</option>
                              </select>
                            </td>
                            <td class="text-center">3</td>
                            <td class="text-center"> - </td>
                            <td class="text-nowrap">
                              <input type="text" class="form-control">
                            </td>
                            <td class="d-flex">
                              <button class="btn btn-danger mr-2"><i class="fa fa-trash"></i></button>
                              <button type="button" class="btn btn-primary" onclick="CopyTableRow()"><i class="fa fa-plus"></i></button>
                            </td>
                          </tr>
                        </tbody>

                      </table>
                    </div>
                  </div>
              </div>
            </div>
            </div>
          </div>
        </section>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn bg-light-secondary"
          data-dismiss="modal"
        >
          Close
        </button>
        <button
          id="addProductRow"
          type="button"
          class="btn bg-light-primary"
          data-backdrop="false"
          data-toggle="modal"
          data-target="#addProduct"
          onclick="copyLaborRow()"
          data-dismiss="modal"
        >
          <em class="ft-plus font-medium-5"></em> Add
        </button>
      </div>
    </div>
  </div>
</div>
<!-- Create Delivery model End -->

<!-- Script Start -->
<script src="{% static 'vendors/js/sweetalert2.all.min.js' %}"></script>
<script src="{% static 'vendors/js/select2.full.min.js' %}"></script>
<script src="{% static 'app/js/select2.min.js' %}"></script>
<!-- Script End -->

<!-- Copy Table Js Start -->
<script>
  function CopyTableRow() {

    var tableBody = document.getElementById("tableBody");
    console.log("Table Body:", tableBody);

    var rowToCopy = document.getElementById("newProduct");
    console.log("Row to Copy:", rowToCopy);

    totalRows = 1;

    for (var i = 0; i < totalRows; i++) {
      console.log("Copying row", i + 1);
      // Clone the row
      var clonedRow = rowToCopy.cloneNode(true);
      console.log("Cloned Row:", clonedRow);
      tableBody.appendChild(clonedRow);
      console.log("Row appended to table body");
    }
  }
</script>
<!-- Copy Table Js End -->

<!-- Print Script Start -->
<script>
  // Print Script Start
  document.querySelectorAll('.print-button').forEach(button => {
    button.addEventListener('click', function() {
        // Get the ID of the table to print from the button's data-table-id attribute
        var tableId = this.getAttribute('data-table-id');
        var table = document.getElementById(tableId);

        if (table) {
            // Hide print-ignore elements
            var printIgnoreElements = table.querySelectorAll('.print-ignore');
            printIgnoreElements.forEach(el => el.style.display = 'none');

            // Find the table HTML to print
            var tableHtml = table.outerHTML;

            // Create a new window or tab for printing
            var printWindow = window.open('', '', 'height=600,width=800');

            // URL for CSS (adjust this if needed)
            var url = "{% static 'vendors/css/sweetalert2.min.css' %}";

            // Construct the HTML for the print window
            printWindow.document.write('<html><head><title>Print Table</title>');
            printWindow.document.write(`<link rel="stylesheet" href="${url}">`); // Include your CSS file
            printWindow.document.write('<style>table { width: 100%; border-collapse: collapse; } th, td { border: 1px solid #ddd; padding: 8px; } th { background-color: #f2f2f2; }</style>'); // Inline styles for print
            printWindow.document.write('</head><body>');
            printWindow.document.write('<h1>Table Print</h1>');
            printWindow.document.write(tableHtml);
            printWindow.document.write('</body></html>');

            // Close the document and trigger print
            printWindow.document.close();
            printWindow.focus();
            printWindow.print();

            // Restore the print-ignore elements
            printIgnoreElements.forEach(el => el.style.display = '');
        } else {
            console.error("Table with ID " + tableId + " not found.");
        }
    });
  });
</script>
<!-- Print Script End -->


